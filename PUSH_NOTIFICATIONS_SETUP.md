   # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –†–æ–¥–Ω–∏

## üîî –ß—Ç–æ —Ç–∞–∫–æ–µ Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è?

Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–ª—É—á–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ:
- **–í—Ö–æ–¥—è—â–∏—Ö –∑–≤–æ–Ω–∫–∞—Ö** - –¥–∞–∂–µ –∫–æ–≥–¥–∞ –±—Ä–∞—É–∑–µ—Ä –∑–∞–∫—Ä—ã—Ç
- **–ù–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö** - –≤ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —á–∞—Ç–∞—Ö –∏ –æ–±—â–µ–º —á–∞—Ç–µ
- **–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö** - —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, –∞—É–¥–∏–æ –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã

–≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–ª–∞–≥–æ–¥–∞—Ä—è Service Worker –∏ Web Push API.

## ‚úÖ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä (Chrome, Firefox, Safari, Edge)
- HTTPS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è production)
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ê–∫—Ç–∏–≤–Ω—ã–π Service Worker

## üöÄ –ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –†–æ–¥–Ω—è**
2. **–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ** –ø–æ—è–≤–∏—Ç—Å—è –∑–∞–ø—Ä–æ—Å –Ω–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
3. **–ù–∞–∂–º–∏—Ç–µ "–í–∫–ª—é—á–∏—Ç—å"** —á—Ç–æ–±—ã —Ä–∞–∑—Ä–µ—à–∏—Ç—å
4. –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –≤—ã –±—É–¥–µ—Ç–µ –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–≤–æ–Ω–∫–∞—Ö

### –ï—Å–ª–∏ –≤—ã –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏ –∑–∞–ø—Ä–æ—Å:   

**Chrome/Edge:**
1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –∑–∞–º–∫–∞ –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ
2. –ù–∞–π–¥–∏—Ç–µ "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
3. –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ "–†–∞–∑—Ä–µ—à–∏—Ç—å"

**Firefox:**
1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ
2. –ù–∞–π–¥–∏—Ç–µ "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
3. –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ "–†–∞–∑—Ä–µ—à–∏—Ç—å"

**Safari:**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
2. –ù–∞–π–¥–∏—Ç–µ —Å–∞–π—Ç –†–æ–¥–Ω–∏
3. –í–∫–ª—é—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## üîß –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### VAPID –∫–ª—é—á–∏

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç VAPID –∫–ª—é—á–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:

```
VAPID_PUBLIC_KEY=BEl62iUZbU4z7gxWrb94Q6-q6XJ5Q7wXewQIdyT0Z1ySLn0d8l1sp7PV2xF0dWUzchTDslHCMwYVJyWP86VlIXM
VAPID_PRIVATE_KEY=GZIP2z-p8UHtBTami0357IB_5p9rHt2Wy6wGaAw1gIc
```

–≠—Ç–∏ –∫–ª—é—á–∏ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ `.env`. –ï—Å–ª–∏ –Ω—É–∂–Ω—ã –Ω–æ–≤—ã–µ –∫–ª—é—á–∏, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```bash
npm install -g web-push
web-push generate-vapid-keys
```

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å:

1. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker** (`public/sw.js`)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç push-—Å–æ–±—ã—Ç–∏—è –¥–ª—è –∑–≤–æ–Ω–∫–æ–≤ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π

2. **–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** (`public/script.js`)
   - –ü—Ä–∏ –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
   - –°–æ–∑–¥–∞–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
   - –ü–æ–¥–ø–∏—Å–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä

3. **–•—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏** (`server.js`)
   - –ü–æ–¥–ø–∏—Å–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î (—Ç–∞–±–ª–∏—Ü–∞ `push_subscriptions`)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

4. **–û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** (`server.js`)
   - **–ü—Ä–∏ –≤—Ö–æ–¥—è—â–µ–º –∑–≤–æ–Ω–∫–µ**: –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ñ–ª–∞–π–Ω - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push
   - **–ü—Ä–∏ –Ω–æ–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏**: –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push –≤—Å–µ–º –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
   - **–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞**: –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ç–∏–ø–µ —Ñ–∞–π–ª–∞
   - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–Ω–ª–∞–π–Ω - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Socket.IO + push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –∑–≤–æ–Ω–∫–∞:

```javascript
{
  title: "üìû –ó–≤–æ–Ω–æ–∫ –æ—Ç –ò–≤–∞–Ω",
  body: "–í—Ö–æ–¥—è—â–∏–π –∑–≤–æ–Ω–æ–∫",
  tag: "call-123",
  callId: 123,
  caller: "–ò–≤–∞–Ω",
  isCall: true,
  requireInteraction: true,
  actions: [
    { action: "accept", title: "–ü—Ä–∏–Ω—è—Ç—å" },
    { action: "reject", title: "–û—Ç–∫–ª–æ–Ω–∏—Ç—å" }
  ]
}
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è:

```javascript
{
  title: "üí¨ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ò–≤–∞–Ω",
  body: "–ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?",
  tag: "message-–ò–≤–∞–Ω",
  isMessage: true,
  requireInteraction: false
}
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è —Ñ–∞–π–ª–∞:

```javascript
{
  title: "üì∏ –§–∞–π–ª –æ—Ç –ò–≤–∞–Ω",
  body: "photo.jpg",
  tag: "file-–ò–≤–∞–Ω",
  isMessage: true,
  requireInteraction: false
}
```

–¢–∏–ø—ã —Ñ–∞–π–ª–æ–≤:
- üì∏ –§–æ—Ç–æ (image/*)
- üé• –í–∏–¥–µ–æ (video/*)
- üéµ –ê—É–¥–∏–æ (audio/*)
- üìé –î–æ–∫—É–º–µ–Ω—Ç—ã (–æ—Å—Ç–∞–ª—å–Ω–æ–µ)

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ö–∞–∫ –∑–∞—â–∏—â–µ–Ω—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:

1. **VAPID –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ** - —Å–µ—Ä–≤–µ—Ä –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç –∫–∞–∂–¥–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
2. **HTTPS —Ç–æ–ª—å–∫–æ** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º—É –∫–∞–Ω–∞–ª—É
3. **–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç** - Service Worker —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
4. **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** - –¥–∞–Ω–Ω—ã–µ —à–∏—Ñ—Ä—É—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ
5. **–í–∞–ª–∏–¥–∞—Ü–∏—è** - –±—Ä–∞—É–∑–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º

### –ß—Ç–æ –ù–ï –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è:

- –ü–∞—Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∫—Ä–æ–º–µ –∏–º–µ–Ω–∏ –∑–≤–æ–Ω—è—â–µ–≥–æ)
- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–π (—Ç–æ–ª—å–∫–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–∞–ª–∏—á–∏–∏)
- IP –∞–¥—Ä–µ—Å–∞

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. –†–∞–∑—Ä–µ—à–µ–Ω—ã –ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ?
   - Chrome: Settings ‚Üí Privacy ‚Üí Notifications
   - Firefox: Preferences ‚Üí Privacy ‚Üí Permissions ‚Üí Notifications
   - Safari: System Preferences ‚Üí Notifications

2. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ Service Worker?
   - –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Application ‚Üí Service Workers
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π Service Worker

3. –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ HTTPS?
   - Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç HTTPS
   - –õ–æ–∫–∞–ª—å–Ω–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å localhost

4. –í–∫–ª—é—á–µ–Ω—ã –ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –û–°?
   - Windows: Settings ‚Üí System ‚Üí Notifications
   - macOS: System Preferences ‚Üí Notifications
   - Linux: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞

### Service Worker –Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è

```javascript
// –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
navigator.serviceWorker.getRegistrations().then(registrations => {
  console.log('Service Workers:', registrations);
});
```

### –û—à–∏–±–∫–∞ "NotAllowedError"

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫–ª–æ–Ω–∏–ª —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è. –ü–æ–ø—Ä–æ—Å–∏—Ç–µ –µ–≥–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞.

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–æ–∫ –≤ –ë–î:

```sql
SELECT username, created_at FROM push_subscriptions;
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

–°–µ—Ä–≤–µ—Ä –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ —Å–æ–±—ã—Ç–∏—è:
- `‚úÖ Push –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
- `‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ push` - –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ
- `üì® –ü–æ–ª—É—á–µ–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ push` - –Ω–æ–≤–∞—è –ø–æ–¥–ø–∏—Å–∫–∞

## üåê –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ù–∞ Railway:

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `.env` —Å–æ–¥–µ—Ä–∂–∏—Ç VAPID –∫–ª—é—á–∏
2. Service Worker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±—É–¥–µ—Ç –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å—Å—è
3. HTTPS –≤–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ Railway

### –ù–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ:

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ HTTPS (Let's Encrypt)
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ VAPID –∫–ª—é—á–∏ –≤ `.env`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Service Worker –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ `/sw.js`
4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Web Push API](https://developer.mozilla.org/en-US/docs/Web/API/Push_API)
- [Service Workers](https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API)
- [web-push npm](https://www.npmjs.com/package/web-push)
- [VAPID specification](https://datatracker.ietf.org/doc/html/draft-thomson-webpush-vapid)
